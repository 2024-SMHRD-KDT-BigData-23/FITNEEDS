# 📎 운동하러 갈래? 넵..좋아여(팀명: FitNeeds)
![imgae](https://search.pstatic.net/sunny/?src=https%3A%2F%2Fimg.freepik.com%2Fpremium-vector%2Ffitness-logo_565520-393.jpg&type=sc960_832)


## 👀 서비스 소개
* 서비스명: 사용자 운동상태 기반 반응형 웹
* 서비스설명: 
<br>


## 📅 프로젝트 기간
2024.03.18 ~ 2024.04.02 (2주)
<br>

## ⭐ 주요 기능
* 기능1 : 반응형 웹
* 기능2 : 서비스 소개 페이지
* 기능3 : 네이버 로그인 api
* 기능4 : 사용자 ui/ux
* 기능5 : Chart.js를 활용한 다양한 차트 시각화
* 기능6 : 최신뉴스 및 블로그 크롤링
* 기능7 : 예약 서비스 및 Fullcalendar api
<br>

<details>
<summary><b>주요 기능 설명 펼치기</b></summary>
<div markdown="1">

* 기능1 : 반응형 웹
* 기능2 : 서비스 소개 페이지
* 기능3 : 네이버 로그인 api
* 기능4 : 사용자 ui/ux
* 기능5 : Chart.js를 활용한 다양한 차트 시각화
* 기능6 : 최신뉴스 및 블로그 크롤링
* 기능7 : 예약 서비스 및 Fullcalendar api

</div>
</details>

## ⛏ 기술스택
<table>
    <tr>
        <th>구분</th>
        <th>내용</th>
    </tr>
    <tr>
        <td>사용언어</td>
        <td>
            <img src="https://img.shields.io/badge/Java-007396?style=for-the-badge&logo=java&logoColor=white"/>
            <img src="https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=HTML5&logoColor=white"/>
            <img src="https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=CSS3&logoColor=white"/>
            <img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=JavaScript&logoColor=white"/>
        </td>
    </tr>
    <tr>
        <td>라이브러리</td>
        <td>
            <img src="https://img.shields.io/badge/BootStrap-7952B3?style=for-the-badge&logo=BootStrap&logoColor=white"/>
        </td>
    </tr>
    <tr>
        <td>개발도구</td>
        <td>
            <img src="https://img.shields.io/badge/Eclipse-2C2255?style=for-the-badge&logo=Eclipse&logoColor=white"/>
            <img src="https://img.shields.io/badge/VSCode-007ACC?style=for-the-badge&logo=VisualStudioCode&logoColor=white"/>
</tr>
        </td>
    </tr>
    <tr>
        <td>서버환경</td>
        <td>
            <img src="https://img.shields.io/badge/Apache Tomcat-D22128?style=for-the-badge&logo=Apache Tomcat&logoColor=white"/>
            <!-- flask 서버 넣기 img-->
        </td>
    </tr>
    <tr>
        <td>데이터베이스</td>
        <td>
            <img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
        </td>
    </tr>
    <tr>
        <td>협업도구</td>
        <td>
            <img src="https://img.shields.io/badge/Git-F05032?style=for-the-badge&logo=Git&logoColor=white"/>
            <img src="https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=GitHub&logoColor=white"/>
        </td>
    </tr>
</table>


<br>

## ⚙ 시스템 아키텍처(구조) 예시 
![서비스 아키텍처](https://user-images.githubusercontent.com/25995055/169925538-15867bd9-aa0b-42fc-a39b-88981e926e51.png)
<br>

## 📌 SW유스케이스
![image](https://user-images.githubusercontent.com/25995055/178401023-9a015e66-aa6e-4d74-8564-9b1f9d306649.png)
<br>

## 📌 서비스 흐름도
![image](https://user-images.githubusercontent.com/25995055/178401048-d6484bda-a2d7-40e1-998b-2bd195cd9f89.png)
<br>

## 📌 ER다이어그램
![image](https://user-images.githubusercontent.com/25995055/169925318-102784c2-893f-4fd7-bec9-a54c44b669d4.png)
<br>

## 🖥 화면 구성

### 로그인/회원가입/회원괸리/회원수정/회원탈퇴
![image](https://user-images.githubusercontent.com/25995055/178401098-95f15a0e-a2de-415e-83d5-883bb4cb0656.png)
<br>

### 옷 정보/코디 추천(날씨, 팁, 오늘의 코디, 참고할 수 있는 코디)
![image](https://user-images.githubusercontent.com/25995055/178401127-287e6de2-4396-49fc-a107-59c4d5cd55c7.png)
<br>

### 일정/고객센터
![image](https://user-images.githubusercontent.com/25995055/178401150-861f0e93-0f40-4fae-98c1-2099bf513c8d.png)
<br>

## 👨‍👩‍👦‍👦 팀원 역할
<table>
  <tr>
    <td align="center"><img src="https://i.namu.wiki/i/GirsrnQUH-q5qbVv871h4zLg_H1X25k25qY-Vr5DcO6xV8MWdcENwySAA0M62Xyurjt3ezZUbPm7GoVYJRRXWGIAXpWJ0_zsEH0mxNsLH2S_GX54w9exBaOg6io06JjbYZRHQiPSyUwPoLzRFA5aeQ.webp" width="100" height="100"/></td>
    <td align="center"><img src="https://mb.ntdtv.kr/assets/uploads/2019/01/Screen-Shot-2019-01-08-at-4.31.55-PM-e1546932545978.png" width="100" height="100"/></td>
    <td align="center"><img src="https://mblogthumb-phinf.pstatic.net/20160127_177/krazymouse_1453865104404DjQIi_PNG/%C4%AB%C4%AB%BF%C0%C7%C1%B7%BB%C1%EE_%B6%F3%C0%CC%BE%F0.png?type=w2" width="100" height="100"/></td>
    <td align="center"><img src="https://i.pinimg.com/236x/ed/bb/53/edbb53d4f6dd710431c1140551404af9.jpg" width="100" height="100"/></td>
    <td align="center"><img src="https://pbs.twimg.com/media/B-n6uPYUUAAZSUx.png" width="100" height="100"/></td>
  </tr>
  <tr>
    <td align="center"><strong>강아람</strong></td>
    <td align="center"><strong>강우석</strong></td>
    <td align="center"><strong>우동희</strong></td>
    <td align="center"><strong>조범수</strong></td>
    <td align="center"><strong>이지훈</strong></td>
  </tr>
  <tr>
    <td align="center"><b>Front-end</b></td>
    <td align="center"><b>Front-end</b></td>
    <td align="center"><b>Back-end</b></td>
    <td align="center"><b>Back-end</b></td>
    <td align="center"><b>Back-end</b></td>
  </tr>
  <tr>
    <td align="center"><a href="https://github.com/자신의username작성해주세요" target='_blank'>github</a></td>
    <td align="center"><a href="https://github.com/자신의username작성해주세요" target='_blank'>github</a></td>
    <td align="center"><a href="https://github.com/Eehnodu" target='_blank'>github</a></td>
    <td align="center"><a href="https://github.com/자신의username작성해주세요" target='_blank'>github</a></td>
    <td align="center"><a href="https://github.com/자신의username작성해주세요" target='_blank'>github</a></td>
  </tr>
  <tr>
    <td align="center"><b>Frontend</b></td>
    <td align="center"><b>Frontend</b></td>
    <td align="center"><b>DB 설계 및 구축<br>회원관리기능<br>비밀번호 암호화 기능<br>사용자의 운동, 체중 입력 기능<br>신체변화와 운동정보 차트 구현<br>Fullcalendar<br>일정 추가, 수정, 삭제 기능<br>PT예약 일정 연동 기능</b></td>
    <td align="center"><b>Frontend</b></td>
    <td align="center"><b>Frontend</b></td>
  </tr>
</table>

## 🤾‍♂️ 트러블슈팅
  
### 🔨 차트의 오버랩 문제<br
- 문제<br>

  메인 페이지 접속시 오늘 날짜를 기준으로 7일전까지의 데이터를 가져와 시각화함.
  원하는 날짜로 바꾸어 차트의 값을 업데이트 할 경우 기존의 차트가 사라지지 않고 새로운 차트가 덧씌워지는 문제가 발생.

- 원인<br>

  new 연산자를 이용해 새로운 메모리로 할당됨에따라 canvas를 초기화하는게 아닌
  새로운 chart가 기존 차트에 덧씌우듯 표시되는 문제라 사료됨.
 
- 해결방안<br>

  update 메소드와 destroy 메소드 사용.
  update 메소드를 사용하였으나 console.log로 확인하였을때 값의 변경이 일어났지만 기존 차트는 유지됨.
  destory 메소드를 사용하여 기존의 차트 객체를 삭제하고 다시 설정해주는 방법으로 해결.
 
- 코드<br>
```
$("#date_check").on("click", function() {
		let start_date = $("#dateFrom").val();
		let end_date = $("#dateTo").val();
		
		// 기존 차트 데이터 삭제
		if(doughnutChart != undefined){
			doughnutChart.destroy();
		}
		if(lineChart != undefined){
			lineChart.destroy();
		}
		fetchStartExChart(start_date, end_date);
		fetchStartChChart(start_date, end_date);
	});
```

### 🔨 비밀번호 암호화(SHA-256 + Salt)<br>
- 문제<br>

  SHA-256은 단방향 알고리즘의 한 종류로, 해시 값을 이용한 암호화 방식.
  SHA-256을 사용하였을때 같은 비밀번호일 경우 같은 해시 값을 반환함을 확인.

- 원인<br>

  SHA-256은 입력 값에 해당하는 해시 값이 정해져 있음.
  레인보우 테이블을 이용해 해시 값을 통해 원본 문자열의 유추가 가능해짐.
  레인보우 테이블이란? => 해시 함수의 모든 입력값에 대한 결과값을 표로 정리한 것.
 
- 해결방안<br>

  무작위 숫자를 바이트 배열로 변환하여 이를 10진수 문자열로 변환한 Salt값을 추가로 생성.
  로그인 및 개인정보 수정 시 비밀번호의 확인을 위해 해당 Salt값을 알아야하기 때문에
  Member_id에 해당하는 Salt값을 저장하는 tb_salt 테이블을 생성 및 저장.
 
- 코드<br>
```
public class Encrypt {
	/**
	 * 무작위 문자열 Salt 생성
	 * 
	 * @return 생성된 Salt 문자열
	 */
	public static String getSalt() {
		// 1. SecureRandom 객체 생성
		SecureRandom sr = new SecureRandom();
		// 2. 무작위 바이트 배열 salt 생성 (길이: 20)
		byte[] salt = new byte[20];
		// 3. 무작위 바이트로 salt 배열 채우기
		sr.nextBytes(salt);
		// 4. 바이트 배열을 16진수 문자열로 변환하여 반환
		StringBuffer sb = new StringBuffer();
		for (byte b : salt) {
			sb.append(String.format("%02x", b));
		}
		return sb.toString();
	}
	/**
	 * 주어진 암호와 Salt를 이용하여 SHA-256 알고리즘을 적용한 결과를 반환
	 * 
	 * @param pwd  암호
	 * @param salt Salt 문자열
	 * @return 암호와 Salt를 이용하여 적용한 SHA-256 알고리즘 결과
	 */
	public static String getEncrypt(String pwd, String salt) {
		String result = "";
		try {
			// 1. SHA-256 알고리즘을 적용할 MessageDigest 객체 생성
			MessageDigest md = MessageDigest.getInstance("SHA-256");
			// 2. 암호와 Salt를 이용하여 MessageDigest 업데이트
			md.update((pwd + salt).getBytes());
			// 3. 업데이트된 내용으로 해시값 계산
			byte[] pwdSalt = md.digest();
			// 4. 해시값을 16진수 문자열로 변환하여 반환
			StringBuffer sb = new StringBuffer();
			for (byte b : pwdSalt) {
				sb.append(String.format("%02x", b));
			}
			result = sb.toString();
		} catch (NoSuchAlgorithmException e) {
			throw new RuntimeException(e);
		}
		return result;
	}
}
```

### 🔨 비교차트 데이터의 undefined 값<br>
- 문제<br>

  회원의 개인 데이터와 표준 데이터를 비교하기 위해 DB에 저장된 값을 ajax를 통해 불러오는 과정에서
  회원의 개인 데이터가 값을 가져오지만 undefined로 출력되는 문제가 발생.
  
- 원인<br>

  ajax를 통해서 가져온 회원의 개인 데이터가 success문 안에서만 값을 유지하기 때문에 발생하는 문제라 사료됨.
 
- 해결방안<br>

  처음 가져온 회원의 개인 데이터의 success안에서 표준 데이터를 가져오는 ajax문을 사용함으로써
  중첩ajax를 통해 회원의 개인 데이터와 표준 데이터의 값을 유지하면서 비교 차트를 화면에 시각화함. 
 
- 코드<br>
```
// 개인 및 표준 데이터 비교 차트 그리기
function fetchCompareChart() {
		// 개인 데이터 가져오기
		$.ajax({
			url: "MyData",
			type: 'POST',
			dataType: 'json',
			success: (res) => {
				mem_height = res.height;
				mem_weight = res.weight;
				mem_bmi = res.bmi;
				mem_muscle = res.muscle;
				mem_fat_per = res.fat_per;
				// success안에서만 값이 유지되기 때문에
				// 중첩 ajax를 이용하여 차트를 그림
				// 표준데이터 가져오기
				$.ajax({
					url: "StdData",
					type: 'POST',
					dataType: 'json',
					success: (res) => {
						std_height = res.height;
						std_weight = res.weight;
						std_bmi = res.bmi;
						std_muscle = res.muscle;
						std_fat_per = res.fat_per;
						// barChart와 radarChart 그리기
						drawCompareChart();
					},
					error: () => {
						console.log("실패");
					}
				});
			},
			error: () => {
			}
		});
	};
```

